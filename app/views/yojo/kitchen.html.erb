<div class="main-wrapper">
    <div class="main-left">
        <div class="fridge-wrapper">
            <% if user_signed_in? %>
                <div id="fridge" class="fridge-top">
                    <div class="fridge-left">
                        <script>
                            map.clear();
                        </script>
                        <% if @kitchen != nil %>
                            <ul id="kitchen-list">
                            <% @kitchen.ingredients.each do |i| %>
                                <% @ingredient = Ingredient.find(i) %>
                                <li onclick="removeFilter(this)"><%=@ingredient.name%></li>
                                <script>
                                    map.set("<%=@ingredient.name%>", <%=@ingredient.id%>);
                                </script>
                            <% end %>
                            </ul>
                        <% end %> 
                    </div>
                    <span class="fridge-handle-left"></span>
                    <span class="fridge-handle-right"></span>
                </div>
                <div class="fridge-bottom">
                    <input align="right" id="ingredient_search" class="bar" type="text" autofocus>
                    <button id="button" type="button" onclick="addIngredients()">업데이트</button>
                    
                    <div id="ingredient_results"></div>
                    
                    <div id="filters"></div>
                    
                    <script>
                        new app.KitchenIngredients;
                        
                        function addIngredients() {
                            console.log(map);
                            var array = [];
                            map.forEach(function(value, key) {
                                array.push(value);
                            });
                            
                            $.ajax({
                                url : "/yojo/addIngredients",
                                type : "get",
                                data : { user: <%=current_user.id%>,
                                        list: array
                                }
                            });
                        }
                    </script>
                    <span class="fridge-handle-bottom"></span>
                </div>
            <% end %>
        </div>
    </div>
    <div class="main-right">
        <div class="shelf-wrapper">
            <div class="shelf-upper font">
                <ul>
                    <li>
                        <a href="/users/edit"><img class="icon" src="/assets/profile.png" /><p>프로필 수정</p></a>
                    </li>
                    <li>
                      <% if user_signed_in? %>
                        <span>
                            아이디:
                            <p><%= @user.username %></p>
                            이메일:
                            <p><%= @user.email %></p>
                        </span>
                      <% else %>
                        <li>please sign In 
                        </li>
                      <% end %>
                    </li>
                                    
                </ul>
            </div>
            
            <div class="shelf-lower">
                
            </div>
            
            <div class="shelf-bottom">
                <ul>
                    <li class="shelf-yoribook">
                        <a href="/yojo/yori_book/0"><span>요리북</span></a>
                    </li>
                    <li class="shelf-postyori">
                        <a href="/yojo/new_yori"><span>레시피 올리기</span></a>
                    </li>
                    <li class="shelf-yorijohap">
                        <a href="/#search"><span>요리 조합</span></a>
                    </li>
                </ul>
            </div>
        </div>
        
        <div id="carousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                <% @count = 0 %>
                <% @yoris.each do |yori| %>
                    <% if @count % 3 == 0 %>
                        <div class="carousel-item <%if @count == 0%>active<%end%>">
                            <div class="row" style="height: 100%">
                    <% end %>
                    
                    <div class="col-md-4 col-sm-6 portfolio-item">
                        <div class="card h-100">
                            <a href="/"><img class="card-img-top" src="http://placehold.it/700x400" alt=""></a>
                            <div class="card-body1">
                                <h4 class="card-title">
                                    <a href="/yojo/yori/<%=yori.id%>"><%=yori.name%></a>
                                </h4>
                                <p class="card-text"><%=Post.find_by(yori_id: yori.id).main%></p>
                            </div>
                        </div>
                    </div>
                    
                    <% if @count % 3 == 2 %>
                            </div>
                        </div>
                    <% end %>
                    <% @count += 1 %>
                <% end %>
                
                <% if @count % 3 != 0 %>
                        </div>
                    </div>
                <% end %> 
                
                <% if @count > 3 %>
                    <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" ></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                <% end %>
            </div>
        </div>
        
    </div>
</div